@model Crosscutting.EntityTenant.Subasta

@{
    ViewBag.Title = "DetalleProducto";
}

<h2>Detalles</h2>
<div id="myModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h4 class="modal-title" id="myModalLabel">Confirmacion<a class="anchorjs-link" href="#myModalLabel"><span class="anchorjs-icon"></span></a></h4>
            </div>
            <div class="modal-body">
                <p>Esta seguro de comprar este producto?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                <button type="button" onclick="location.href='@Url.Action("FinalizarCompraDirecta/", "Subasta", new { idSubasta = Model.id })'" class="btn btn-primary">Aceptar</button>
            </div>
        </div>
    </div>
</div>

<div class="col-lg-6">
    <div class="col-md-12">
    <img src="@Html.DisplayFor(model => model.portada)">
    </div>
    <div class="col-md-12">
        @if (ViewBag.ListaImg != null)
        {
            <div class="container">

                <div class="row">
                    <div class="col-md-12">
                        <div class="carousel slide" id="carousel-606608">
                            <ol class="carousel-indicators">
                                @{
                                var index = 0;

                                if (ViewBag.ListaImg != null)
                                {
                                    foreach (var imagen in ViewBag.ListaImg)
                                    {
                                        if (index == 0)
                                        {
                                            <li class="active" data-slide-to="0" data-target="#carousel-606608"></li>
                                        }
                                        else
                                        {
                                            <li data-slide-to="@index" data-target="#carousel-606608"></li>
                                        }

                                        index++;
                                    }
                                }
                                }

                            </ol>
                            <div class="carousel-inner">

                                @if (ViewBag.ListaImg != null)
                                {
                                    index = 0;

                                    foreach (var imagen in ViewBag.ListaImg)
                                    {
                                        if (index == 0)
                                        {
                                            <div class="item active">
                                                <img alt="" src="@imagen.uri" />
                                            </div>
                                        }
                                        else
                                        {
                                            <div class="item">
                                                <img alt="" src="@imagen.uri" />
                                            </div>
                                        }

                                        index++;
                                    }
                                }

                            </div>
                            <a data-slide="prev" href="#carousel-606608" class="left carousel-control">‹</a> <a data-slide="next" href="#carousel-606608" class="right carousel-control">›</a>
                        </div>
                    </div>
                </div>
            </div>
        }

    </div>
</div>
<div class="col-lg-6">
    <div class="table-responsive">
        <table class="table">
            <thead>
                <tr>
                    <th>Tipo de Finalizacion</th>
                    <th>@Html.DisplayFor(model => model.finalizado)</th>
                </tr>
                <tr>
                    <th>Vendedor</th>
                    <th>@Html.DisplayFor(model => model.id_Vendedor)</th>
                </tr>
                <tr>
                    <th>Producto</th>
                    <th>@Html.DisplayFor(model => model.id_Producto)</th>
                </tr>
                <tr>
                    <th>Valor Actual</th>
                    <th>@Html.DisplayFor(model => model.valor_Actual)</th>
                </tr>
                <tr>
                    <th>Fecha Inicio</th>
                    <th>@Html.DisplayFor(model => model.fecha_Inicio)</th>
                </tr>
                <tr>
                    <th>Fecha Cierre</th>
                    <th>@Html.DisplayFor(model => model.fecha_Cierre)</th>
                </tr>
                <tr>
                    <th>Estado</th>
                    <th>@Html.DisplayFor(model => model.estado)</th>
                </tr>

            </thead>
        </table>
    </div>
</div>

    @using Site.Models
    @{
        var user = Session["usuario"] as UsuarioSite;
        var estado = Model.estado.ToString();
        var tipoFinalizacion = Model.finalizado.ToString();
    }

    @if (estado.Equals("Activa"))
    {

        if (user != null && user.Email != null)
        {

            if (tipoFinalizacion == "Subasta")
            {
                <div class="jumbotron">
                    <button type="button" onclick="location.href='@Url.Action("CreateOferta/", "Oferta", new { idSubasta = Model.id, monto_actual =Model.valor_Actual })'" class="btn btn-default">Ofertar</button>
                    <button type="button" onclick="location.href='@Url.Action("Lista/", "Oferta", new { idSubasta = Model.id, monto_actual =Model.valor_Actual })'" class="btn btn-default">Ver Ofertas</button>
                </div>
            }
            else
            {
                <div class="jumbotron">
                    <button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal">Comprar!</button>
                </div>
            }
        }
        else
        {
            <p>Debe loguarse para poder ofertar</p>
        }
    }
    else
    {
        <p>La publicacion está finalizada</p>
    }

    <div class="jumbotron">
        @*<button type="button" onclick="location.href='@Url.Action("Edit", "Subasta"), new { id = Model.id }'" class="btn btn-default">Editar</button>*@
        <button type="button" onclick="location.href='@Url.Action("Index", "Tenant")'" class="btn btn-default">Volver</button>
    </div>


